# Redis μ§μ ‘ κµ¬ν„ν•λ©° λ°°μ°κΈ°

## π“‹ Stage λ©λ΅

| Stage | μ λ© | λ‚μ΄λ„ |
|-------|------|--------|
| 1 | ν¬νΈμ— λ°”μΈλ”©ν•κΈ° | β¬¤β—‹β—‹ λ§¤μ° μ‰¬μ›€ |
| 2 | PINGμ— μ‘λ‹µν•κΈ° | β¬¤β—‹β—‹ μ‰¬μ›€ |
| 3 | μ—¬λ¬ PINGμ— μ‘λ‹µν•κΈ° | β¬¤β—‹β—‹ μ‰¬μ›€ |
| **4** | **λ™μ‹ ν΄λΌμ΄μ–ΈνΈ μ²λ¦¬ν•κΈ°** | β¬¤β¬¤β—‹ λ³΄ν†µ |
| 5 | ECHO λ…λ Ήμ–΄ κµ¬ν„ν•κΈ° | β¬¤β¬¤β—‹ λ³΄ν†µ |
| 6 | SET & GET λ…λ Ήμ–΄ κµ¬ν„ν•κΈ° | β¬¤β¬¤β—‹ λ³΄ν†µ |
| 7 | ν‚¤ λ§λ£(Expiry) κµ¬ν„ν•κΈ° | β¬¤β¬¤β—‹ λ³΄ν†µ |

---

## Stage 4: λ™μ‹ ν΄λΌμ΄μ–ΈνΈ μ²λ¦¬ν•κΈ°

### π― λ©ν‘

μ΄μ „ λ‹¨κ³„κΉμ§€λ” ν• λ²μ— ν•λ‚μ ν΄λΌμ΄μ–ΈνΈλ§ μ²λ¦¬ν•  μ μμ—μµλ‹λ‹¤. μ΄λ²μ—λ” **μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ™μ‹μ— μ²λ¦¬**ν•  μ μλ„λ΅ μ„λ²„λ¥Ό κ°μ„ ν•©λ‹λ‹¤.

---

### π“ λ°°κ²½ μ§€μ‹

#### λ™μ‹μ„± μ²λ¦¬ λ°©μ‹

μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ™μ‹μ— μ²λ¦¬ν•λ” λ°©λ²•μ€ ν¬κ² μ„Έ κ°€μ§€κ°€ μμµλ‹λ‹¤:

| λ°©μ‹ | μ„¤λ… | μ¥μ  | λ‹¨μ  |
|------|------|------|------|
| **λ©€ν‹°μ¤λ λ“** | ν΄λΌμ΄μ–ΈνΈλ§λ‹¤ μƒ μ¤λ λ“ μƒμ„± | κµ¬ν„ κ°„λ‹¨ | μ¤λ λ“ μ¤λ²„ν—¤λ“ |
| **μ¤λ λ“ ν’€** | λ―Έλ¦¬ μƒμ„±ν• μ¤λ λ“ μ¬μ‚¬μ© | ν¨μ¨μ μΈ λ¦¬μ†μ¤ μ‚¬μ© | ν’€ ν¬κΈ° κ΄€λ¦¬ ν•„μ” |
| **μ΄λ²¤νΈ λ£¨ν”„** | λ‹¨μΌ μ¤λ λ“μ—μ„ λΉ„λ™κΈ° μ²λ¦¬ | λ§¤μ° λ†’μ€ μ„±λ¥ | κµ¬ν„ λ³µμ΅ |

> π’΅ μ‹¤μ  Redisλ” **λ‹¨μΌ μ¤λ λ“ μ΄λ²¤νΈ λ£¨ν”„** λ°©μ‹μ„ μ‚¬μ©ν•©λ‹λ‹¤. ν•μ§€λ§ μ΄ λ‹¨κ³„μ—μ„λ” μ΄ν•΄ν•κΈ° μ‰¬μ΄ **λ©€ν‹°μ¤λ λ“** λ°©μ‹μΌλ΅ κµ¬ν„ν•©λ‹λ‹¤.

#### μ™ λ™μ‹μ„±μ΄ μ¤‘μ”ν•κ°€?

ν”„λ΅λ•μ… ν™κ²½μ—μ„ Redisλ” μλ°±~μμ² κ°μ ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ„ λ™μ‹μ— μ²λ¦¬ν•΄μ•Ό ν•©λ‹λ‹¤. μ›Ή μ„λ²„μ μ—¬λ¬ μΈμ¤ν„΄μ¤, λ°±κ·ΈλΌμ΄λ“ μ›μ»¤, λ°°μΉ μ‘μ—… λ“±μ΄ λ¨λ‘ λ™μ‹μ— Redisμ— μ ‘κ·Όν•κΈ° λ•λ¬Έμ…λ‹λ‹¤.

---

### β… ν†µκ³Ό μ΅°κ±΄

- μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈκ°€ λ™μ‹μ— μ—°κ²°ν•  μ μμ–΄μ•Ό ν•©λ‹λ‹¤
- κ° ν΄λΌμ΄μ–ΈνΈμ `PING` λ…λ Ήμ–΄μ— λ…λ¦½μ μΌλ΅ μ‘λ‹µν•΄μ•Ό ν•©λ‹λ‹¤
- ν• ν΄λΌμ΄μ–ΈνΈμ μ—°κ²°μ΄ λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈλ¥Ό λΈ”λ΅ν‚Ήν•μ§€ μ•μ•„μ•Ό ν•©λ‹λ‹¤

---

### π’΅ ννΈ

κ° ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ„ λ³„λ„μ μ¤λ λ“μ—μ„ μ²λ¦¬ν•©λ‹λ‹¤.

```kotlin
import java.net.ServerSocket
import kotlin.concurrent.thread

fun main() {
    val serverSocket = ServerSocket(6379)
    serverSocket.reuseAddress = true
    
    println("Redis μ„λ²„ μ‹μ‘: ν¬νΈ 6379")
    
    while (true) {
        val clientSocket = serverSocket.accept()
        println("μƒ ν΄λΌμ΄μ–ΈνΈ μ—°κ²°: ${clientSocket.inetAddress}")
        
        // κ° ν΄λΌμ΄μ–ΈνΈλ¥Ό λ³„λ„ μ¤λ λ“μ—μ„ μ²λ¦¬
        thread {
            handleClient(clientSocket)
        }
    }
}

fun handleClient(clientSocket: java.net.Socket) {
    val reader = clientSocket.getInputStream().bufferedReader()
    val writer = clientSocket.getOutputStream().bufferedWriter()
    
    try {
        while (true) {
            val line = reader.readLine() ?: break
            
            // TODO: RESP νμ‹± λ° PING μ‘λ‹µ μ²λ¦¬
            
            writer.flush()
        }
    } catch (e: Exception) {
        println("ν΄λΌμ΄μ–ΈνΈ μ²λ¦¬ μ¤‘ μ¤λ¥: ${e.message}")
    } finally {
        clientSocket.close()
        println("ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μΆ…λ£")
    }
}
```

---

### π§ ν…μ¤νΈ λ°©λ²•

μ—¬λ¬ ν„°λ―Έλ„μ—μ„ λ™μ‹μ— redis-cliλ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤:

**ν„°λ―Έλ„ 1:**
```bash
redis-cli
127.0.0.1:6379> PING
PONG
```

**ν„°λ―Έλ„ 2 (ν„°λ―Έλ„ 1μ΄ μ—°κ²°λ μƒνƒμ—μ„):**
```bash
redis-cli
127.0.0.1:6379> PING
PONG
```

λ‘ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ΅ λΈ”λ΅ν‚Ή μ—†μ΄ λ™μ‹μ— μ‘λ‹µμ„ λ°›μΌλ©΄ μ„±κ³µμ…λ‹λ‹¤!

**μλ™ν™” ν…μ¤νΈ:**
```bash
# λ°±κ·ΈλΌμ΄λ“μ—μ„ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰
for i in {1..5}; do
    redis-cli PING &
done
wait
# 5κ°μ PONGμ΄ μ¶λ ¥λμ–΄μ•Ό ν•¨
```

---

### π¤” μƒκ°ν•΄λ³Ό μ 

1. **μ¤λ λ“ μ μ ν•**: ν΄λΌμ΄μ–ΈνΈκ°€ 10,000κ°λΌλ©΄ μ¤λ λ“λ„ 10,000κ° μƒμ„±ν•΄μ•Ό ν• κΉμ”? μ¤λ λ“ ν’€μ„ μ‚¬μ©ν•λ©΄ μ–΄λ–»κ² λ κΉμ”?

2. **μ‹¤μ  Redisμ μ„ νƒ**: Redisλ” μ™ λ©€ν‹°μ¤λ λ“ λ€μ‹  λ‹¨μΌ μ¤λ λ“ μ΄λ²¤νΈ λ£¨ν”„λ¥Ό μ„ νƒν–μ„κΉμ”?
   - Redisμ λ€λ¶€λ¶„ μ‘μ—…μ€ λ©”λ¨λ¦¬ κΈ°λ°μ΄λΌ λ§¤μ° λΉ λ¦„ (λ§μ΄ν¬λ΅μ΄ λ‹¨μ„)
   - μ»¨ν…μ¤νΈ μ¤μ„μΉ­ μ¤λ²„ν—¤λ“ μ κ±°
   - λ½ μ—†μ΄ λ°μ΄ν„° κµ¬μ΅° μ΅°μ‘ κ°€λ¥ (thread-safe κ³ λ ¤ λ¶ν•„μ”)

---

### β΅οΈ λ‹¤μ λ‹¨κ³„

Stage 5μ—μ„λ” `ECHO` λ…λ Ήμ–΄λ¥Ό κµ¬ν„ν•λ©°, μΈμλ¥Ό λ°›λ” λ…λ Ήμ–΄ μ²λ¦¬ λ°©λ²•μ„ λ°°μ›λ‹λ‹¤.
